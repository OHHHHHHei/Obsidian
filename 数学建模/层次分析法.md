# 建立层次结构模型

1. 目标层：是我们想要达到的最佳目标
2. 准则层：是我们为了实现目标需要考虑的所有因素
3. 方案层：这里是可供我们选择的具体方案
# 核心理念

决策是一个主观的过程，不同的人有不同的偏好和需求

# 构造判断矩阵

我们把准则层中的所有因素拿出来，两两进行比较，来确定它们相对重要性的比值。

为了量化这个“稍微重要”，我们使用一个叫做“1-9标度法”的表格来给它们打分。比如，1表示同等重要，3表示稍微重要，5表示重要，7表示非常重要，9表示极端重要。

**通过这个方法，我们就可以把你的主观判断，转化成一个可以进行数学运算的矩阵。**

接下来，我们要做一个非常重要的数学计算：**求出这个判断矩阵的特征向量**。这个特征向量里的每个数值，就代表了对应准则的重要性权重。
## 计算特征向量

你在比较“交通便利性”和“景点丰富度”时，你可能觉得“景点”稍微重要一些，给它打了3分。然后你又比较“景点丰富度”和“旅行费用”，觉得“景点”比“费用”更重要，给它打了5分。

如果现在你再来比较“交通便利性”和“旅行费用”，你的直觉判断可能和前两次的打分产生冲突。

我们来把这个“冲突”具体化一下。
假设你的判断是这样的：
1. 你认为“景点丰富度”比“交通便利性”**稍微重要**一些，你给了它一个相对重要性分值 3。
2. 你认为“景点丰富度”比“旅行费用”**非常重要**，你给了它一个相对重要性分值 7。
现在，如果只凭你的直觉，让你直接比较“交通便利性”和“旅行费用”，你可能会觉得“费用”很重要，甚至比“交通”更重要，比如你给了它一个分值 4。
但是，让我们用数学的眼光来检查一下。
根据你前两次的判断，我们可以推导出第三次判断的“理论值”：
- 如果 “景点”的重要性是“交通”的 3 倍，
- 并且 “景点”的重要性是“费用”的 7 倍，
- 那么根据简单的比例关系，“旅行费用”的重要性就应该是“交通便利性”的 $\frac{3}{7}$​ 倍。
所以，从你的前两次判断来看，你的直觉判断中“交通”应该比“费用”更重要，它们之间的比值应该是 $\frac{3}{7}$ 左右。但是你直接打分的时候，却给出了一个相反的结论（“费用”比“交通”重要，分值为 4）。
这就产生了我们所说的**不一致性**。

层次分析法的判断矩阵和特征向量，就是为了解决这种主观判断中可能出现的**不一致性**。它通过复杂的数学运算，把你的所有两两比较的结果综合起来，找到一个最能代表你整体偏好的“平均”结果，也就是我们说的**权重**。

这个过程就像是在一个团队中，每个人都给出了自己的意见，而我们要做的就是找到一个最能反映大家共同意见的最终方案。
## 一致性检验

简单来说，一致性检验就是用来衡量你的两两比较判断（也就是你给出的分数）是否具有逻辑上的一致性。

### 计算一致性指标 (CI)
这个指标是用来衡量你的判断矩阵偏离完全一致性的程度。当一个矩阵完全一致时，它的 $CI=0$。$CI$ 的值越大，说明你判断的不一致性越严重。$CI$ 的计算公式是：

$$CI = \frac{λ_{max}​−n​}{n−1}$$
其中，$λ_{max}$​ 是你的判断矩阵的 **最大特征值**，而 $n$ 是矩阵的阶数（也就是你比较的因素数量）。
### 查找平均随机一致性指标(RI)

为了知道你的 $CI$ 值是高还是低，我们需要一个参考标准。这个标准就是**平均随机一致性指标**（Random Index），它是在大量的随机判断矩阵中计算出来的平均一致性指标。不同的矩阵阶数 $n$ 对应不同的 $RI$ 值，这些值通常是已知的。
### 计算一致性比例

最后一步，我们将你的 $CI$ 值和对应的 $RI$ 值进行比较，计算出**一致性比例**（Consistency Ratio），公式是：

$$CR=\frac{CI}{RI}$$​

如果你的 $CR<0.1$，那么我们认为这个判断矩阵的一致性是可以接受的，你可以继续后面的步骤。如果 $CR≥0.1$，就说明你的判断有比较严重的逻辑矛盾，你需要回去重新调整你的判断矩阵（也就是重新打分），直到 $CR$ 满足要求。
# 计算权重

我们是通过求判断矩阵的**最大特征值**和对应的**特征向量**来得到权重的。
我们得到权重的步骤是：
1. **构造判断矩阵**：根据你对各个准则的两两比较打分，构建一个正互反矩阵。
2. **求最大特征值和特征向量**：通过数学计算，解出这个矩阵的最大特征值 $λ_{max}$​ 以及其对应的特征向量 $W$。
3. **归一化**：将求得的特征向量 $W$ 进行归一化处理，使其所有元素的和为1。归一化后的向量就是我们想要的**权重向量**。
# 选择方案

我们已经有了：
- **准则层**的权重，比如：交通、景点、费用、住宿各自的重要性。
- **方案层**的判断矩阵，也就是在每个准则下，我们对每个旅游地点（北京、上海、杭州）的打分。比如，我们比较“北京”和“上海”在“交通便利性”这个准则下的优劣。

## 层次总排序

我们可以用一个公式来表示这个过程：

$$W_{final}​=W_{criteria​}×A_{alternatives}$$​

其中：
- $W_{final}$​ 是最终的方案总排序向量，它代表了每个方案的最终得分。
- $W_{criteria​}$是准则层的权重向量，它包含了你之前计算出来的“交通”、“景点”、“费用”等因素的权重。
- $A_{alternatives}$ 是方案层的判断矩阵，它是由每个方案在不同准则下的得分组成的。

**简单来说，这个过程就是：**

**最终得分 = （准则A的权重 × 方案在准则A下的得分） + （准则B的权重 × 方案在准则B下的得分）+ ...**

通过这个加权平均的过程，我们将你在各个准则下的主观判断，与这些准则本身的重要性结合起来，最终得出一个客观的、可以量化的总分。得分最高的方案，就是层次分析法推荐的最佳选择。












