# 分层思想

全称：通用异步收发协议。

分为三层：物理信号层，链路传输层，应用数据层。

## 物理信号层

硬件电路的设计规则，接线方式，传输信号与电平的对应关系，传输速度，同步异步传输，收发模式等。

## 链路传输层

地址（ID），冲突的检测与避免（仲裁），误码校验，滤波器与掩码。该层的帧格式。

## 应用数据层

被传输的数据主体。

# 物理信号

两个模块的点对点通信。（不存在冲突）

Rx，接收端

Tx，发送端

GND，两个模块需要共地，才能区分Rx与Tx的电平高低。

接线方式：

![[image 12.png]]

传输0/1码元：高电平是1，低电平是0。

单片机高电平为3.3V，低电平为0V。

## 比特率

bit/s，bps。每秒钟传输的二进制码元的数量。

## 波特率

symbol/s。每秒钟传输的有效信息码元的数量。

UART通信中，比特率等于波特率，因为有效信息码元直接对应二进制的0/1码元。

## 异步通信

## 收发模式

仅接收，仅发送，收发双向。

## UART是点到点的协议，因此没有地址或者ID的概念。

# 误码校验

采用的是奇偶校验算法。

## 奇偶校验法

奇校验：奇数个1则为0，偶数个1则为1。

偶校验：奇数个1则为1，偶数个1则为0。

# 链路传输

![[image 13.png]]

# 阻塞/终端/DMA中断

# ==记得使能中断==

## 阻塞通信

MCU一个字节一个字节发送

一个字节一个字节接收

## 中断通信

MCU发送一个字节给外设，外设发送完之后再让MCU发下一个

对面给我发消息，产生一个中断事件，然后MCU看到中断事件了再一个字节一个字节接收

## DMA中断通信

直接内存访问，不产生数据，只是数据的搬运工

MCU把指定发送的数据的地址和长度告诉DMA，DMA帮忙搬运给外设，发送完成之后告诉MCU

MCU让DMA把外设发给单片机的消息搬运到指定位置，可以让DMA选择接收方式，等MCU通知搬运或者一直搬运，搬运完成之后会触发相应的中断事件。

# 空闲中断

当UART卸下来之后，会把之前连续接收到的内容自动拼装成一段有效的信息存到缓冲区当中

但是对于多段信息，可能会无法区分出事一条还是多条有效的消息。